#compdef iwfm

endpoints=( "${(@f)$(iwfm endpoints | sed -nE 's/^ *([^:]+): (.*)$/\\:\1[\2]/p')}" )
endpoints=( $endpoints 'iwfm\://' 'iwfms\://' )
if (( CURRENT == 2 )) ; then
  cmds=( "${(@f)$(iwfm help | sed -nE 's/^  ([^ ]+).*- (.+)$/\1[\2]/p')}" )
  cmds=( $cmds $endpoints )
  _values "iwfm command" $cmds
else
  _values "iwfm endpoints" $endpoints
fi
